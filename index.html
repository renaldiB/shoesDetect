<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- ... (CSS and meta tags) ... -->
  </head>
  <body>
    <button id="button">Mulai</button>
    <input
      type="text"
      id="resultBox"
      readonly
      style="overflow: auto; text-overflow: ellipsis"
    />
    <button id="switchCameraButton">Switch Camera</button>
  </body>

  <script src="https://cdn.jsdelivr.net/npm/p5@latest/lib/p5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/p5@latest/lib/addons/p5.dom.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ml5@latest/dist/ml5.min.js"></script>
  <script type="text/javascript">
    let classifier;
    let imageModelURL = "./model/";
    let video;
    let flippedVideo;
    let cameraActive = false;
    let frontCameraActive = false; // Default to rear camera

    function preload() {
      classifier = ml5.imageClassifier(imageModelURL + "model.json");
    }

    function setup() {
      createCanvas(320, 260);
      toggleCamera();
      video.hide();
      flippedVideo = ml5.flipImage(video);
    }

    function draw() {
      background(0);
      if (cameraActive) {
        image(flippedVideo, 0, 0);
      }
    }

    function classifyVideo() {
      flippedVideo = ml5.flipImage(video);
      classifier.classify(flippedVideo, gotResult);
      flippedVideo.remove();
    }

    function gotResult(error, results) {
      label = results[0].label;
      if (cameraActive) {
        classifyVideo();
      }
      document.getElementById("resultBox").value = label;
    }

    function toggleCamera() {
      if (video) {
        video.stop();
      }
      if (frontCameraActive) {
        video = createCapture(VIDEO);
      } else {
        video = createCapture({ audio: false, video: { facingMode: "environment" } });
      }
      video.size(320, 260);
      video.hide();
      classifyVideo();
    }

    const startButton = document.getElementById("button");
    startButton.addEventListener("click", function () {
      if (!cameraActive) {
        video.play();
        cameraActive = true;
        classifyVideo();
      }
    });

    const switchCameraButton = document.getElementById("switchCameraButton");
    switchCameraButton.addEventListener("click", function () {
      frontCameraActive = !frontCameraActive;
      toggleCamera();
    });
  </script>
</html>
